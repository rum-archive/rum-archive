<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/main.css" />
  <script src="/js/main.js"></script>
  <title>RUM Archive - Methodology</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#006a80">
  <meta name="msapplication-TileColor" content="#006a80">
  <meta name="theme-color" content="#006a80">

  <!-- Facebook Meta Tags -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="RUM Archive - Methodology">
  <meta property="og:image" content="https://rumarchive.com/assets/rum-archive-banner-facebook-1200x630.png">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="twitter:domain" content="rumarchive.com">
  <meta name="twitter:title" content="RUM Archive - Methodology">
  <meta name="twitter:image" content="https://rumarchive.com/assets/rum-archive-banner-twitter-1600x900.png">

  <link rel="feed alternate" type="application/atom+xml" href="/blog/feed.xml" title="Atom Feed">

  <script>(function(){if(window.BOOMR&&(window.BOOMR.version||window.BOOMR.snippetExecuted)){return}window.BOOMR=window.BOOMR||{};window.BOOMR.snippetStart=(new Date).getTime();window.BOOMR.snippetExecuted=true;window.BOOMR.snippetVersion=15;window.BOOMR.url="//c.go-mpulse.net/boomerang/S4RHZ-UABWM-G9DGN-GKRY7-DUGEG";var e=document.currentScript||document.getElementsByTagName("script")[0],a=e.parentNode,s=false,t=3e3;function n(){if(s){return}var e=document.createElement("script");e.id="boomr-scr-as";e.src=window.BOOMR.url;e.async=true;a.appendChild(e);s=true}function i(e){s=true;var t,i=document,n,o,d,r=window;window.BOOMR.snippetMethod=e?"if":"i";n=function(e,t){var n=i.createElement("script");n.id=t||"boomr-if-as";n.src=window.BOOMR.url;BOOMR_lstart=(new Date).getTime();e=e||i.body;e.appendChild(n)};if(!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [678]\./)){window.BOOMR.snippetMethod="s";n(a,"boomr-async");return}o=document.createElement("IFRAME");o.src="about:blank";o.title="";o.role="presentation";o.loading="eager";d=(o.frameElement||o).style;d.width=0;d.height=0;d.border=0;d.display="none";a.appendChild(o);try{r=o.contentWindow;i=r.document.open()}catch(e){t=document.domain;o.src="javascript:var d=document.open();d.domain='"+t+"';void 0;";r=o.contentWindow;i=r.document.open()}r._boomrl=function(){n()};if(r.addEventListener){r.addEventListener("load",r._boomrl,false)}else if(r.attachEvent){r.attachEvent("onload",r._boomrl)}i.close()}var o=document.createElement("link");if(o.relList&&typeof o.relList.supports==="function"&&o.relList.supports("preload")&&"as"in o){window.BOOMR.snippetMethod="p";o.href=window.BOOMR.url;o.rel="preload";o.as="script";o.addEventListener("load",n);o.addEventListener("error",function(){i(true)});setTimeout(function(){if(!s){i(true)}},t);BOOMR_lstart=(new Date).getTime();a.appendChild(o)}else{i(false)}function d(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(window.addEventListener){window.addEventListener("load",d,false)}else if(window.attachEvent){window.attachEvent("onload",d)}})();</script>
</head>
<body>
  <header><nav class="navbar is-light" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="/">
      <img src="/assets/rum-archive-logo-square.svg" width="28" height="28" />
    </a>

    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar-main">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbar-main" class="navbar-menu">
    <div class="navbar-start">
      <div class="navbar-item has-text-weight-bold">
        <a href="/">RUM Archive</a>
      </div>
    </div>

    <div class="navbar-end">
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link" href="/docs/">
          Documentation
        </a>

        <div class="navbar-dropdown">
          <a class="navbar-item" href="/docs/methodology">
            Methodology
          </a>
          <a class="navbar-item" href="/docs/querying">
            Querying
          </a>
          <a class="navbar-item" href="/docs/tables">
            Tables
          </a>
          <a class="navbar-item" href="/docs/samples">
            Samples
          </a>
          <a class="navbar-item" href="/docs/tips">
            Tips
          </a>
          <a class="navbar-item" href="/docs/release-notes">
            Release  Notes
          </a>
        </div>
      </div>

      <a href="/datasets" class="navbar-item">
        Datasets
      </a>

      <a href="/blog" class="navbar-item">
        Blog
      </a>

      <a href="/insights" class="navbar-item">
        Insights
      </a>

      <a href="/contribute" class="navbar-item">
        Contribute!
      </a>

      <a href="https://github.com/rum-archive/rum-archive" class="navbar-item">
        Github
      </a>

      <a href="/about" class="navbar-item">
        About
      </a>
    </div>
  </div>
</nav>
</header>
  <main>
    
<article class="page-layout">
  <div class="container">
    <div class="columns">
      <div class="column is-10 is-offset-1">
        <div class="content m-5">
          <h1>Methodology</h1>
          
            <h2>Table of Contents</h2>
            <aside>
              <div class="toc" >
        <ul><li><a href="#overview">Overview</a></li><li><a href="#aggregation">Aggregation</a><ul><li><a href="#minimum-count-threshold">Minimum Count Threshold</a></li><li><a href="#histogram-bucketing">Histogram Bucketing</a></li><li><a href="#histogram-format">Histogram Format</a></li><li><a href="#page-loads-histogram-buckets">Page Loads Histogram Buckets</a></li><li><a href="#third-party-resource-histogram-buckets">Third-Party Resource Histogram Buckets</a></li></ul></li><li><a href="#example-aggregation-queries">Example Aggregation Queries</a></li><li><a href="#exporting">Exporting</a></li><li><a href="#querying">Querying</a></li></ul>
      </div>
            </aside>
          
          <h2 id="overview" tabindex="-1">Overview</h2>
<p>The RUM Archive datasets contain aggregated Real User Monitoring (RUM) data from one or more websites.</p>
<p>Each <a href="/datasets">dataset</a> in the RUM Archive publishes aggregated RUM data to public <a href="https://cloud.google.com/bigquery">Google BigQuery</a> tables.</p>
<p>There are two types of <a href="/docs/tables">tables</a> within the RUM Archive:</p>
<ul>
<li><strong>Page Loads</strong>: Browser page load experiences</li>
<li><strong>Resources</strong>: Third party resource fetches</li>
</ul>
<p>The documentation on this page describes how this RUM data is aggregated, exported and made available for querying.</p>
<h2 id="aggregation" tabindex="-1">Aggregation</h2>
<p>All data published to the RUM Archive is <strong>sanitized</strong> and <strong>aggregated</strong>.</p>
<p>The goal of aggregation is twofold:</p>
<ul>
<li>To protect the privacy of individuals who visit a website</li>
<li>To reduce the amount of data that needs to be stored in the tables, so that vast quantities of data can be represented</li>
</ul>
<p>In order to generate queryable aggregated data, each RUM Archive table shares a common pattern in the columns it contains:</p>
<ul>
<li>Multiple <strong>Dimensions</strong> that describe the aggregate data, such as date, browser, geographic region, or protocol
<ul>
<li>Each row represents a unique tuple of those dimensions</li>
</ul>
</li>
<li>A <strong>Count</strong> of the number of datapoints that match that unique tuple</li>
<li><strong>Timers or Metrics</strong> that are aggregated into Histograms and other statistics like Avg or SumLn</li>
</ul>
<p>With the data exported in this format, anyone wanting to combine, aggregate, slice, filter or group by any of the available
dimensions can also calculate statistics about the Timers and Metrics for that group of data:</p>
<ul>
<li>By using the <strong>Histogram</strong> columns, queries can calculate <strong>approximate percentiles</strong> of the data (from 0th to 100th).</li>
<li>By using the <strong>Avg</strong> columns and <strong>Count</strong> columns, queries can calculate the <strong>average</strong> of data.</li>
<li>By using the <strong>SumLn</strong> and <strong>Count</strong> columns, queries can calculate the <strong>geometric mean</strong> of data.</li>
</ul>
<p>Here's an example screenshot of a few rows of the Dimension and Count columns.  Each row has a distinct set (tuple) of columns, and a <code>Count</code> of how many experiences matched those tuples:</p>
<p><img src="/assets/methodology-dimensions.png" alt="BigQuery example of Page Load Rows"></p>
<p>Looking at a few further columns for the same rows, you can see the Page Load Time columns (<code>PLT*</code>) show a Histogram, Avg, SumLn and Count of those aggregated datapoints.</p>
<p><img src="/assets/methodology-timers.png" alt="BigQuery example of Page Load Rows"></p>
<h3 id="minimum-count-threshold" tabindex="-1">Minimum Count Threshold</h3>
<p>Some datasets may have a Minimum Count Threshold for aggregated data.  For example, the mPulse <a href="/datasets">dataset</a> has
a Minimum Count Threshold for the Page Loads table of 5, so all tuples in the exported data that aren't represented by <strong>at least</strong> 5
unique hits will be discarded.</p>
<p>Other datasets may have a Minimum Count Threshold of 1, so all available data is represented in the dataset.  For example, the <a href="/datasets/#akamai-employee-individual-websites-datasets">Akamai Employee Individual Datasets</a> contain all of the page load events for each day.</p>
<p>The downside of applying a Minimum Count Threshold is that <strong>outliers</strong>, by definition, will be discarded and not represented
in the queryable dataset.</p>
<p>Discarding outliers <strong>will affect</strong> the accuracy of queries.  For example, in the mPulse dataset, we estimate that discarding any tuples with less than 5 hits could affect 50th percentile (median) calculations by around 2.9% and 95th percentile calculations by 7%.  Please take this into consideration when querying the data.</p>
<h3 id="histogram-bucketing" tabindex="-1">Histogram Bucketing</h3>
<p>RUM Archive tables contain several Histogram columns, one for each timer or metric that is aggregated.</p>
<p>These Histogram columns are used to <a href="/docs/querying">calculate</a> approximate percentiles of the data.</p>
<p>Each Histogram is a frequency distribution of datapoints for that timer/metric, according to the bucket widths described below.</p>
<p>All Histograms contain 152 buckets:</p>
<ul>
<li>Zero values: 1 bucket (bucket 0)</li>
<li>High precision: 100 buckets (buckets 1-100)</li>
<li>Low precision: 50 buckets (buckets 101-150)</li>
<li>Anything higher than the Max: 1 bucket (bucket 151)</li>
</ul>
<p>High precision buckets are on the low end of the expected value range, and represent values where the impact of the metric
changing is the highest.  For example, Page Load Time's High Precision buckets start at 0 and go to 10,000ms in 100 equally-sized
100ms buckets.</p>
<p>Low precision buckets extend to the numbers beyond the High Max, using buckets 10x the width of the High Width.  For example,
Page Load Time's Low Precision buckets start at 10,001ms and extend to 60,000ms in 50 equally-sized 1,000ms buckets.</p>
<p>Having both High precision and Low precision buckets allows us to represent data from a large range of possible values while
still providing high precision to the values that matter most (on the low end of the range).</p>
<p>By combining all of the Histograms for columns matching a query, and running the <a href="/docs/querying">fast histogram</a> algorithm
on the combined Histograms, one can calculate the approximate percentile for any timer/metric.</p>
<h3 id="histogram-format" tabindex="-1">Histogram Format</h3>
<p>Histograms are stored in a JSON object format.</p>
<p>Each key represents the bucket number, and the value is an array of two values:</p>
<ul>
<li><code>[0]</code> is the mean of values in that bucket</li>
<li><code>[1]</code> is the count of values in that bucket</li>
</ul>
<p>An example Page Load Histogram for a single row may look like this:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>    <span class="token property">"102"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">11679</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token property">"103"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">12803</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token property">"106"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">15876</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token property">"113"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">22532</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token property">"117"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">26026</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><br><span class="token punctuation">}</span></code></pre>
<p>In the above example, there are 6 values:</p>
<ul>
<li>Bucket # 102, which represents data between 11,000ms and 11,999ms has a single value, of 11,679ms.</li>
<li>Bucket # 106, which represents data between 15,000ms and 15,999ms has a 2 values, with a mean of 15,876ms.</li>
</ul>
<h3 id="page-loads-histogram-buckets" tabindex="-1">Page Loads Histogram Buckets</h3>
<p>Page Loads have following bucket histogram definitions:
â€‹</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">Metric</th>
<th style="text-align:left">Column Name</th>
<th style="text-align:right">High Width (ms)</th>
<th style="text-align:right">High Min (ms)</th>
<th style="text-align:right">High Max (ms)</th>
<th style="text-align:right">Low Width (ms)</th>
<th style="text-align:right">Low Min (ms)</th>
<th style="text-align:right">Low Max (ms)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Page Load Time</td>
<td style="text-align:left"><code>PLTHISTOGRAM</code></td>
<td style="text-align:right">100</td>
<td style="text-align:right">0</td>
<td style="text-align:right">10,000</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">10,001</td>
<td style="text-align:right">60,000</td>
</tr>
<tr>
<td style="text-align:left">DNS</td>
<td style="text-align:left"><code>DNSHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">TCP</td>
<td style="text-align:left"><code>TCPHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">TLS</td>
<td style="text-align:left"><code>TLSHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Time to First Byte</td>
<td style="text-align:left"><code>TTFBHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">First Contentful Paint</td>
<td style="text-align:left"><code>FCPHISTOGRAM</code></td>
<td style="text-align:right">100</td>
<td style="text-align:right">0</td>
<td style="text-align:right">10,000</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">10,001</td>
<td style="text-align:right">60,000</td>
</tr>
<tr>
<td style="text-align:left">Largest Contentful Paint</td>
<td style="text-align:left"><code>LCPHISTOGRAM</code></td>
<td style="text-align:right">100</td>
<td style="text-align:right">0</td>
<td style="text-align:right">10,000</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">10,001</td>
<td style="text-align:right">60,000</td>
</tr>
<tr>
<td style="text-align:left">Round Trip Time</td>
<td style="text-align:left"><code>RTTHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Rage Clicks <a href="#page-loads-histogram-buckets-notes"><sup><em>1</em></sup></a></td>
<td style="text-align:left"><code>RAGECLICKSHISTOGRAM</code></td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">100</td>
<td style="text-align:right">10</td>
<td style="text-align:right">101</td>
<td style="text-align:right">600</td>
</tr>
<tr>
<td style="text-align:left">Cumulative Layout Shift (*1000)</td>
<td style="text-align:left"><code>CLSHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">First Input Delay</td>
<td style="text-align:left"><code>FIDHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Interaction to Next Paint</td>
<td style="text-align:left"><code>INPHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Total Blocking Time</td>
<td style="text-align:left"><code>TBTHISTOGRAM</code></td>
<td style="text-align:right">100</td>
<td style="text-align:right">0</td>
<td style="text-align:right">10,000</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">10,001</td>
<td style="text-align:right">60,000</td>
</tr>
<tr>
<td style="text-align:left">Time to Interactive</td>
<td style="text-align:left"><code>TTIHISTOGRAM</code></td>
<td style="text-align:right">100</td>
<td style="text-align:right">0</td>
<td style="text-align:right">10,000</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">10,001</td>
<td style="text-align:right">60,000</td>
</tr>
<tr>
<td style="text-align:left">Redirect</td>
<td style="text-align:left"><code>REDIRECTHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Unattributed Navigation Overhead</td>
<td style="text-align:left"><code>UNOHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
</tbody>
</table>
</div>
<p><a name="page-loads-histogram-buckets-notes"></a>
Notes:</p>
<ol>
<li><code>rageClicksHistogram</code> was changed on 2023-01-01, see the <a href="/blog/2023-03-16-mpulse-january-data-rage-clicks-change">blog post</a> for details.</li>
</ol>
<h3 id="third-party-resource-histogram-buckets" tabindex="-1">Third-Party Resource Histogram Buckets</h3>
<p>Third-Party Resource fetches have following bucket histogram definitions:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">Metric</th>
<th style="text-align:left">Column Name</th>
<th style="text-align:right">High Width (ms/b)</th>
<th style="text-align:right">High Min (ms/b)</th>
<th style="text-align:right">High Max (ms/b)</th>
<th style="text-align:right">Low Width (ms/b)</th>
<th style="text-align:right">Low Min (ms/b)</th>
<th style="text-align:right">Low Max (ms/b)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Total Time</td>
<td style="text-align:left"><code>TOTALHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">DNS Time</td>
<td style="text-align:left"><code>DNSHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">TCP Time</td>
<td style="text-align:left"><code>TCPHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">TLS Time</td>
<td style="text-align:left"><code>TLSHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Request Time</td>
<td style="text-align:left"><code>REQUESTHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Response Time</td>
<td style="text-align:left"><code>RESPONSEHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Time to First Byte</td>
<td style="text-align:left"><code>TTFBHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Download Time</td>
<td style="text-align:left"><code>DOWNLOADHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Redirect Time</td>
<td style="text-align:left"><code>REDIRECTHISTOGRAM</code></td>
<td style="text-align:right">10</td>
<td style="text-align:right">0</td>
<td style="text-align:right">1,000</td>
<td style="text-align:right">100</td>
<td style="text-align:right">1,001</td>
<td style="text-align:right">6,000</td>
</tr>
<tr>
<td style="text-align:left">Cached<a href="#resources-histogram-buckets-notes"><sup><em>1</em></sup></a></td>
<td style="text-align:left"><code>CACHEDHISTOGRAM</code></td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
<td style="text-align:right">-</td>
</tr>
<tr>
<td style="text-align:left">Encoded Body Size</td>
<td style="text-align:left"><code>ENCODEDSIZEHISTOGRAM</code></td>
<td style="text-align:right">1000</td>
<td style="text-align:right">0</td>
<td style="text-align:right">100,000</td>
<td style="text-align:right">10,000</td>
<td style="text-align:right">100,001</td>
<td style="text-align:right">600,000</td>
</tr>
<tr>
<td style="text-align:left">Decoded Body Size</td>
<td style="text-align:left"><code>DECODEDSIZEHISTOGRAM</code></td>
<td style="text-align:right">1000</td>
<td style="text-align:right">0</td>
<td style="text-align:right">100,000</td>
<td style="text-align:right">10,000</td>
<td style="text-align:right">100,001</td>
<td style="text-align:right">600,000</td>
</tr>
<tr>
<td style="text-align:left">Transfer Size</td>
<td style="text-align:left"><code>TRANSFERSIZEHISTOGRAM</code></td>
<td style="text-align:right">1000</td>
<td style="text-align:right">0</td>
<td style="text-align:right">100,000</td>
<td style="text-align:right">10,000</td>
<td style="text-align:right">100,001</td>
<td style="text-align:right">600,000</td>
</tr>
</tbody>
</table>
</div>
<p><a name="resources-histogram-buckets-notes"></a>
Notes:</p>
<ol>
<li><code>cached</code> is boolean (either <code>0</code> or <code>1</code>)</li>
</ol>
<h2 id="example-aggregation-queries" tabindex="-1">Example Aggregation Queries</h2>
<p>Generating data in this format can be done with standard SQL queries.</p>
<p>The exact SQL will depend on the schema of the source table, but the mPulse Dataset provides an example SQL query in the <a href="https://github.com/rum-archive/rum-archive/tree/main/samples/bigquery/aggregation">rum-archive Github repository</a>.</p>
<h2 id="exporting" tabindex="-1">Exporting</h2>
<p>Once RUM Archive data has been generated, it should be exported to CSV or TSV and loaded into a Google BigQuery dataset.</p>
<p>The schemas for Page Loads and Resources tables are available in the <a href="https://github.com/rum-archive/rum-archive/tree/main/samples/bigquery/schemas">rum-archive Github repository</a>.</p>
<p>A convenient way to import TSV files into BigQuery is by uploading those files to a Google Cloud Storage bucket:</p>
<pre class="language-bash"><code class="language-bash">gsutil <span class="token parameter variable">-m</span> <span class="token function">cp</span> <span class="token parameter variable">-Z</span> <span class="token parameter variable">-n</span> *.tsv gs://%BUCKET%/</code></pre>
<p>Then executing a BigQuery <code>LOAD DATA INTO</code> command:</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">LOAD</span> <span class="token keyword">DATA</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>%PROJECT%.%DATASET%.%PREFIX%_page_loads<span class="token punctuation">`</span></span><br><span class="token punctuation">(</span><br>    SOURCE STRING<span class="token punctuation">,</span><br>    SITE STRING<span class="token punctuation">,</span><br>    <span class="token keyword">DATE</span> <span class="token keyword">DATE</span><span class="token punctuation">,</span><br>    DEVICETYPE STRING<span class="token punctuation">,</span><br>    USERAGENTFAMILY STRING<span class="token punctuation">,</span><br>    USERAGENTVERSION STRING<span class="token punctuation">,</span><br>    DEVICEMODEL STRING<span class="token punctuation">,</span><br>    OS STRING<span class="token punctuation">,</span><br>    OSVERSION STRING<span class="token punctuation">,</span><br>    BEACONTYPE STRING<span class="token punctuation">,</span><br>    COUNTRY STRING<span class="token punctuation">,</span><br>    VISIBILITYSTATE STRING<span class="token punctuation">,</span><br>    NAVIGATIONTYPE STRING<span class="token punctuation">,</span><br>    PROTOCOL STRING<span class="token punctuation">,</span><br>    IPVERSION STRING<span class="token punctuation">,</span><br>    LANDINGPAGE <span class="token keyword">BOOLEAN</span><span class="token punctuation">,</span><br>    BEACONS <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    PLTHISTOGRAM STRING<span class="token punctuation">,</span><br>    PLTAVG FLOAT64<span class="token punctuation">,</span><br>    PLTSUMLN FLOAT64<span class="token punctuation">,</span><br>    PLTCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    DNSHISTOGRAM STRING<span class="token punctuation">,</span><br>    DNSAVG FLOAT64<span class="token punctuation">,</span><br>    DNSSUMLN FLOAT64<span class="token punctuation">,</span><br>    DNSCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    TCPHISTOGRAM STRING<span class="token punctuation">,</span><br>    TCPAVG FLOAT64<span class="token punctuation">,</span><br>    TCPSUMLN FLOAT64<span class="token punctuation">,</span><br>    TCPCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    TLSHISTOGRAM STRING<span class="token punctuation">,</span><br>    TLSAVG FLOAT64<span class="token punctuation">,</span><br>    TLSSUMLN FLOAT64<span class="token punctuation">,</span><br>    TLSCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    TTFBHISTOGRAM STRING<span class="token punctuation">,</span><br>    TTFBAVG FLOAT64<span class="token punctuation">,</span><br>    TTFBSUMLN FLOAT64<span class="token punctuation">,</span><br>    TTFBCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    FCPHISTOGRAM STRING<span class="token punctuation">,</span><br>    FCPAVG FLOAT64<span class="token punctuation">,</span><br>    FCPSUMLN FLOAT64<span class="token punctuation">,</span><br>    FCPCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    LCPHISTOGRAM STRING<span class="token punctuation">,</span><br>    LCPAVG FLOAT64<span class="token punctuation">,</span><br>    LCPSUMLN FLOAT64<span class="token punctuation">,</span><br>    LCPCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    RTTHISTOGRAM STRING<span class="token punctuation">,</span><br>    RTTAVG FLOAT64<span class="token punctuation">,</span><br>    RTTSUMLN FLOAT64<span class="token punctuation">,</span><br>    RTTCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    RAGECLICKSHISTOGRAM STRING<span class="token punctuation">,</span><br>    RAGECLICKSAVG FLOAT64<span class="token punctuation">,</span><br>    RAGECLICKSSUMLN FLOAT64<span class="token punctuation">,</span><br>    RAGECLICKSCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    CLSHISTOGRAM STRING<span class="token punctuation">,</span><br>    CLSAVG FLOAT64<span class="token punctuation">,</span><br>    CLSSUMLN FLOAT64<span class="token punctuation">,</span><br>    CLSCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    FIDHISTOGRAM STRING<span class="token punctuation">,</span><br>    FIDAVG FLOAT64<span class="token punctuation">,</span><br>    FIDSUMLN FLOAT64<span class="token punctuation">,</span><br>    FIDCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    TBTHISTOGRAM STRING<span class="token punctuation">,</span><br>    TBTAVG FLOAT64<span class="token punctuation">,</span><br>    TBTSUMLN FLOAT64<span class="token punctuation">,</span><br>    TBTCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    TTIHISTOGRAM STRING<span class="token punctuation">,</span><br>    TTIAVG FLOAT64<span class="token punctuation">,</span><br>    TTISUMLN FLOAT64<span class="token punctuation">,</span><br>    TTICOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    REDIRECTHISTOGRAM STRING<span class="token punctuation">,</span><br>    REDIRECTAVG FLOAT64<span class="token punctuation">,</span><br>    REDIRECTSUMLN FLOAT64<span class="token punctuation">,</span><br>    REDIRECTCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    INPHISTOGRAM STRING<span class="token punctuation">,</span><br>    INPAVG FLOAT64<span class="token punctuation">,</span><br>    INPSUMLN FLOAT64<span class="token punctuation">,</span><br>    INPCOUNT <span class="token keyword">INTEGER</span><span class="token punctuation">,</span><br>    UNOHISTOGRAM STRING<span class="token punctuation">,</span><br>    UNOAVG FLOAT64<span class="token punctuation">,</span><br>    UNOSUMLN FLOAT64<span class="token punctuation">,</span><br>    UNOCOUNT <span class="token keyword">INTEGER</span><br><span class="token punctuation">)</span><br><span class="token keyword">FROM</span> FILES <span class="token punctuation">(</span><br>  format <span class="token operator">=</span> <span class="token string">'CSV'</span><span class="token punctuation">,</span><br>  field_delimiter <span class="token operator">=</span> <span class="token string">'\t'</span><span class="token punctuation">,</span><br>  skip_leading_rows <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  uris <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'gs://%BUCKET%/%FILE%.tsv'</span><span class="token punctuation">]</span><br><span class="token punctuation">)</span><br><span class="token punctuation">;</span><br></code></pre>
<h2 id="querying" tabindex="-1">Querying</h2>
<p>Please see the <a href="/docs/querying">Querying</a> guide for how to query RUM Archive data.</p>

        </div>
      </div>
    </div>
  </div>
</article>

  </main>
  <footer class="footer">
    <div class="content has-text-centered">
      <p>
        Sponsored by <a href="https://akamai.com"><img src="/assets/akamai-logo.svg" style="position:relative;top:4px;height:26px" alt="Akamai logo"></a>
      </p>
      <p>
        The website content is licensed
        <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
      </p>
      <p>
        <a href="https://twitter.com/RUMArchive">twitter</a> -
        <a href="https://bsky.app/profile/rumarchive.com">bluesky</a> -
        <a rel="me" href="https://webperf.social/@rumarchive">mastodon</a>
      </p>
    </div>
  </footer>
</body>
</html>
